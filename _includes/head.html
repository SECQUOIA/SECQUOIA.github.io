<head>
	<title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=5.0">
	<meta name="description" content="{{ page.description | default: site.description }}">
	
	<!-- Preload critical fonts -->
	<link rel="preload" href="{{ "assets/fonts/fontawesome-webfont.woff2?v=4.6.3" | relative_url }}" as="font" type="font/woff2" crossorigin>
	<!-- Add other critical fonts if needed -->
	
	<!--[if lte IE 8]><script src="{{ "assets/js/ie/html5shiv.js" | relative_url }}"></script><![endif]-->
	<link rel="stylesheet" href="{{ "assets/css/main.css" | relative_url }}" />
	<link rel="shortcut icon" type="image/x-icon" href="{{ '/assets/images/favicon.ico' | relative_url }}">
	
	<!-- Highlight.js - for code syntax highlighting -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
	<!-- Add specific language support -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/julia.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/r.min.js"></script>
	
	<!-- WebP detection script -->
	<script>
	  // Check if the browser supports WebP
	  function checkWebpSupport() {
	    var img = new Image();
	    img.onload = function() {
	      var result = (img.width > 0) && (img.height > 0);
	      if(result) {
	        document.documentElement.classList.add('webp');
	      }
	    };
	    img.onerror = function() {
	      // WebP not supported
	    };
	    img.src = 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=';
	  }
	  
	  // Run the detection
	  checkWebpSupport();
	</script>
	
	<!--[if lte IE 9]><link rel="stylesheet" href="{{ "assets/css/ie9.css" | relative_url }}" /><![endif]-->
	<!--[if lte IE 8]><link rel="stylesheet" href="{{ "assets/css/ie8.css" | relative_url }}" /><![endif]-->
	
  	{% if jekyll.environment == 'production' and site.google_analytics %}
  	{% include analytics.html %}
  	{% endif %}
	
	<script>
	// Defer Google Tag Manager loading for better performance
	window.addEventListener('load', function() {
	  setTimeout(function() {
	    var gtmScript = document.createElement('script');
	    gtmScript.async = true;
	    gtmScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-7SN6EM0RMM';
	    document.head.appendChild(gtmScript);
	    
	    window.dataLayer = window.dataLayer || [];
	    function gtag(){dataLayer.push(arguments);}
	    gtag('js', new Date());
	    gtag('config', 'G-7SN6EM0RMM', {
	      'send_page_view': false // We'll send pageviews manually for better control
	    });
	    
	    // Send pageview after GTM is loaded
	    gtmScript.onload = function() {
	      gtag('event', 'page_view', {
	        page_title: document.title,
	        page_location: window.location.href,
	        page_path: window.location.pathname
	      });
	    };
	  }, 1000); // 1-second delay, adjust as needed
	});
	</script>
</head>
